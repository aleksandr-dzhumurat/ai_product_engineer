# –ú—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å –≤ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

**–ú—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å** ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –¥–≤–∞ –∏–ª–∏ –±–æ–ª–µ–µ –ø—Ä–∏–∑–Ω–∞–∫–∞ **—Å–∏–ª—å–Ω–æ –ª–∏–Ω–µ–π–Ω–æ –∑–∞–≤–∏—Å–∏–º—ã** –º–µ–∂–¥—É —Å–æ–±–æ–π.

- –§–æ—Ä–º–∞–ª—å–Ω–æ: –¥–ª—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ $X_1, X_2, ..., X_n$

    –µ—Å–ª–∏ $X_i \approx a \cdot X_j + b$, —ç—Ç–æ —É–∂–µ –ø—Ä–æ–±–ª–µ–º–∞.

## –ü—Ä–∏–º–µ—Ä

- $X_1$ = —Ä–æ—Å—Ç –≤ —Å–º
- $X_2$ = —Ä–æ—Å—Ç –≤ –º–µ—Ç—Ä–∞—Ö
- –û—á–µ–≤–∏–¥–Ω–æ, –æ–Ω–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ª–∏–Ω–µ–π–Ω–æ –∑–∞–≤–∏—Å–∏–º—ã.

## –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞

1. **–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏**
    - –ú–∞–ª—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö ‚Üí –±–æ–ª—å—à–∏–µ –∫–æ–ª–µ–±–∞–Ω–∏—è $\beta$
    - –¢—Ä—É–¥–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏
2. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Ä–∞—Å—Ç—É—Ç**
    - p-values —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º–∏
    - –¢—Ä—É–¥–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
3. **–ü–æ–Ω–∏–∂–∞–µ—Ç—Å—è —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –≤–Ω–µ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏**
    - –ú–æ–¥–µ–ª—å –ø–µ—Ä–µ–æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏

## –í–ª–∏—è–Ω–∏–µ –Ω–∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫—É

–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Ä–µ—à–∞–µ—Ç:

$$\hat{\beta} = (X^TX)^{-1} X^Ty$$

- –ï—Å–ª–∏ $X^TX$ –ø–æ—á—Ç–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–∞ –∏–∑-–∑–∞ –∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ ‚Üí $(X^TX)^{-1}$ –ø–ª–æ—Ö–æ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è
- –†–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí –æ–≥—Ä–æ–º–Ω—ã–µ –∏–ª–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å

### VIF (Variance Inflation Factor)

$$\text{VIF}_i = \frac{1}{1 - R_i^2}$$

- $R_i^2$ ‚Äî –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ $X_i$ –Ω–∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
- VIF > 5‚Äì10 ‚Üí –ø—Ä–æ–±–ª–µ–º–∞

### –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞

- –ï—Å–ª–∏ $|\text{corr}(X_i, X_j)| > 0.8$ ‚Üí –ø—Ä–∏–∑–Ω–∞–∫ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω—ã–π

---

## –ö–∞–∫ –±–æ—Ä–æ—Ç—å—Å—è

### üîπ 1. –£–¥–∞–ª–µ–Ω–∏–µ / –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

- –£–¥–∞–ª—è–µ–º –æ–¥–∏–Ω –∏–∑ —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∏—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, PCA –∏–ª–∏ —Å—Ä–µ–¥–Ω–µ–µ)

---

### üîπ 2. –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è

**Ridge (L2)**
- "–°–∂–∏–º–∞–µ—Ç" –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã, —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Ö
- –£–º–µ–Ω—å—à–∞–µ—Ç –≤–ª–∏—è–Ω–∏–µ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏

**Lasso (L1)**
- –ú–æ–∂–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω—É–ª—è—Ç—å –æ–¥–∏–Ω –∏–∑ –∑–∞–≤–∏—Å–∏–º—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

---

### üîπ 3. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

**PCA / SVD**
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤ **–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ –≤–∞–∂–Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å, –∞ –Ω–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è

# Metrics

* [mape-vs-smape](https://towardsdatascience.com/choosing-the-correct-error-metric-mape-vs-smape-5328dec53fac)
* [ml-meets-economic](https://nicolas.kruchten.com/content/2016/01/ml-meets-economics/)
* [Yandex ML handbook](https://education.yandex.ru/handbook/ml/article/metriki-klassifikacii-i-regressii)

–§–∏–ª–æ—Å–æ—Ñ–∏—è sklearn: Sklearn –≤–∫–ª—é—á–∞–µ—Ç –º–µ—Ç–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ:

* –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã ‚úì
* –•–æ—Ä–æ—à–æ –∏–∑—É—á–µ–Ω—ã –≤ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–µ ‚úì
* –ò–º–µ—é—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚úì
* –†–∞–±–æ—Ç–∞—é—Ç –≤ –æ–±—â–µ–º —Å–ª—É—á–∞–µ ‚úì

MAPE –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç —ç—Ç–∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏:

* –ù–µ—Ç –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è
* –ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–π —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏
* –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω—É–ª–µ–≤—ã–º–∏/–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
* –°–º–µ—â–µ–Ω–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:

–ú–æ–∂–Ω–æ –æ–±—É—á–∏—Ç—å –ª–∏–Ω–µ–π–Ω—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é, –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è MAPE —á–µ—Ä–µ–∑ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫

## MAE:

`from sklearn.linear_model import QuantileRegressor`

–ü–ª—é—Å—ã MAE:

* –£—Å—Ç–æ–π—á–∏–≤–∞ –∫ –≤—ã–±—Ä–æ—Å–∞–º
* –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º–∞ –≤–µ–∑–¥–µ –∫—Ä–æ–º–µ –Ω—É–ª—è
* –ù–µ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ y_true
* –ù–µ—Å–º–µ—â–µ–Ω–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏

## HuberLoss

`from sklearn.linear_model import HuberRegressor`

* –ö–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç MSE –∏ MAE
* –£—Å—Ç–æ–π—á–∏–≤–∞ –∫ –≤—ã–±—Ä–æ—Å–∞–º
* –ì–ª–∞–¥–∫–∞—è –∏ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º–∞—è

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RMSE

–°–ª—É—á–∞–π 1: –ë–æ–ª—å—à–∏–µ –æ—à–∏–±–∫–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã. –ü—Ä–∏–º–µ—Ä: –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–ü–µ—Ä–µ–¥–æ–∑–∏—Ä–æ–≤–∫–∞ –Ω–∞ 20 –º–≥ –æ–ø–∞—Å–Ω–µ–µ, —á–µ–º —á–µ—Ç—ã—Ä–µ —Ä–∞–∑–∞ –ø–æ ¬±5 –º–≥ ‚Üí –Ω—É–∂–µ–Ω RMSE.

```python
y_true = [100, 100, 100, 100]  # –º–≥
y_pred_A = [105, 95, 105, 95]  # –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ–ª–∫–∏—Ö –æ—à–∏–±–æ–∫
y_pred_B = [100, 100, 100, 80]  # –æ–¥–Ω–∞ –±–æ–ª—å—à–∞—è –æ—à–∏–±–∫–∞

MAE_A = 5.0   MAE_B = 5.0   # –æ–¥–∏–Ω–∞–∫–æ–≤–æ
RMSE_A = 5.0  RMSE_B = 10.0 # B —Ö—É–∂–µ! ‚úì
```

–ü—Ä–æ–≥–Ω–æ—â –æ—Ç—Å—Ç–∞—Ç–∫–æ–≤

–ó–∞—Ç—Ä–∞—Ç—ã –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã: –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∞ –¥–æ—Ä–æ–∂–µ –∏–∑-–∑–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–∫–ª–∞–¥—Å–∫–∏—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤.

```python
# –ù–µ–¥–æ–æ—Ü–µ–Ω–∫–∞ –Ω–∞ 1000 –µ–¥–∏–Ω–∏—Ü
y_true = 10000
y_pred = 9000
# –£–ø—É—â–µ–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å: 1000 * —Ü–µ–Ω–∞

# –ü–µ—Ä–µ–æ—Ü–µ–Ω–∫–∞ –Ω–∞ 1000 –µ–¥–∏–Ω–∏—Ü
y_true = 10000  
y_pred = 11000
# –ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ: 1000 * (—Ü–µ–Ω–∞ + —Å–∫–ª–∞–¥–∏—Ä–æ–≤–∞–Ω–∏–µ)
```

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ MAE, –Ω–æ —Å –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –ø–æ—Ç–µ—Ä—å, RMSE —Å–∏–ª—å–Ω–µ–µ —à—Ç—Ä–∞—Ñ—É–µ—Ç –±–æ–ª—å—à–∏–µ –æ—à–∏–±–∫–∏ (–∏–∑-–∑–∞ –∫–≤–∞–¥—Ä–∞—Ç–∞), –Ω–æ –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –∑–∞—Ç—Ä–∞—Ç—ã —Ä–∞—Å—Ç—É—Ç –ª–∏–Ω–µ–π–Ω–æ —Å —Ä–∞–∑–º–µ—Ä–æ–º –æ—à–∏–±–∫–∏, –∞ –Ω–µ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ

```python
def asymmetric_loss(y_true, y_pred, overestimation_weight=1.5):
    """
    overestimation_weight > 1.0 –µ—Å–ª–∏ –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∞ –¥–æ—Ä–æ–∂–µ
    """
    errors = y_true - y_pred
    loss = np.where(errors < 0,  # –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∞ (pred > true)
                    np.abs(errors) * overestimation_weight,
                    np.abs(errors))  # –Ω–µ–¥–æ–æ—Ü–µ–Ω–∫–∞
    return np.mean(loss)
```

–ü—Ä–æ–±–ª–µ–º—ã MAPE:

* –î–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å: –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ø—Ä–∏ y_true = 0
* –ê—Å–∏–º–º–µ—Ç—Ä–∏—è: —Å–∏–ª—å–Ω–µ–µ —à—Ç—Ä–∞—Ñ—É–µ—Ç –Ω–µ–¥–æ–æ—Ü–µ–Ω–∫—É, —á–µ–º –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫—É

–û—à–∏–±–∫–∞ -10% –ø—Ä–∏ y=100 ‚Üí –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ 90 ‚Üí MAPE = 10%
–û—à–∏–±–∫–∞ +10% –ø—Ä–∏ y=100 ‚Üí –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ 110 ‚Üí MAPE = 9.1%


* –ù–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –≤ —Ç–æ—á–∫–∞—Ö y_pred = y_true (–∏–∑-–∑–∞ –º–æ–¥—É–ª—è)
* –°–º–µ—â–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è: –º–æ–∂–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–µ–¥–æ–æ—Ü–µ–Ω–∫–µ

–ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫
* –ï—Å—Ç—å –≤—ã–±—Ä–æ—Å—ã? ‚Üí MAE
* –ù–µ—Ç –≤—ã–±—Ä–æ—Å–æ–≤, –Ω–æ –±–æ–ª—å—à–∏–µ –æ—à–∏–±–∫–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã? ‚Üí RMSE
* –ù–µ —É–≤–µ—Ä–µ–Ω? ‚Üí Huber Loss (–∑–æ–ª–æ—Ç–∞—è —Å–µ—Ä–µ–¥–∏–Ω–∞)
* –ü–æ–ø—Ä–æ–±—É–π –æ–±–∞ –∏ —Å—Ä–∞–≤–Ω–∏ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏!

# –í—ã–±–æ—Ä ML-–º–µ—Ç—Ä–∏–∫ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø—Ä–æ—Å–∞

## –¶–µ–ø–æ—á–∫–∞ –º–µ—Ç—Ä–∏–∫

```
–ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∞ ‚Üí –¢–∞—Ä–≥–µ—Ç ‚Üí ML-–º–µ—Ç—Ä–∏–∫–∞ ‚Üí Loss
```

## –í—ã–±–æ—Ä —Ç–∞—Ä–≥–µ—Ç–∞

### –ò–¥–µ–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å **–ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–∏–±—ã–ª–∏** (Œî Profit), —Ç.–∫. –∏–º–µ–Ω–Ω–æ –µ–≥–æ –º—ã —Ö–æ—Ç–∏–º –º–∞–∫—Å–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å.

### –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä—è–º–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∞ –ø—Ä–∏–±—ã–ª–∏
- –ü—Ä–∏–±—ã–ª—å –æ—á–µ–Ω—å **–≤–æ–ª–∞—Ç–∏–ª—å–Ω–∞**
- –ó–∞–≤–∏—Å–∏—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –æ—Ç —Å–∫–∏–¥–æ–∫, –Ω–æ –∏ –æ—Ç **—Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞–∫—É–ø–∫–∏**

### –ü—Ä–∞–∫—Ç–∏—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å **–ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–¥–∞–∂** (Œî Sales), –∑–∞—Ç–µ–º —á–µ—Ä–µ–∑ —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é —Ñ–æ—Ä–º—É–ª—É –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–∏–±—ã–ª–∏:

$$
\Delta \text{Profit} = \text{Profit}_t - \text{Profit}_{t-1}
$$

$$
\Delta \text{Profit} = (\text{Sales}_{t-1} + \Delta \text{Sales}) \times (\text{price} - \text{discount} - \text{cost}) - \text{Sales}_{t-1} \times (\text{price} - \text{cost})
$$

---

## –ö–ª—é—á–µ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–∏ –≤—ã–±–æ—Ä–µ ML-–º–µ—Ç—Ä–∏–∫–∏

### 1. –õ–∏–Ω–µ–π–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –æ—à–∏–±–∫–∏
**–í–æ–ø—Ä–æ—Å:** –ù–∞—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–∞—à–Ω—ã –±–æ–ª—å—à–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞?

- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ —Å 0 –¥–æ 100 –∏ —Å 100 –¥–æ 200 —Å—ä–µ–¥–∞–µ—Ç **–æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ** –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–±—ã–ª–∏?

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –≤—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫–∏:**
- –ï—Å–ª–∏ –ø–æ—Ç–µ—Ä–∏ —Ä–∞—Å—Ç—É—Ç **–Ω–µ–ª–∏–Ω–µ–π–Ω–æ** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **RMSE** (–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —à—Ç—Ä–∞—Ñ—É–µ—Ç –±–æ–ª—å—à–∏–µ –æ—à–∏–±–∫–∏ —Å–∏–ª—å–Ω–µ–µ)
- –ï—Å–ª–∏ –ø–æ—Ç–µ—Ä–∏ —Ä–∞—Å—Ç—É—Ç **–ª–∏–Ω–µ–π–Ω–æ** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **MAE** (–ª–∏–Ω–µ–π–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)

**–î–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞ —Å–ø—Ä–æ—Å–∞:** –ø–æ—Ç–µ—Ä–∏ –æ–±—ã—á–Ω–æ —Ä–∞—Å—Ç—É—Ç –ª–∏–Ω–µ–π–Ω–æ ‚Üí –≤—ã–±–∏—Ä–∞–µ–º **MAE –∏–ª–∏ —Å—Ö–æ–∂—É—é –º–µ—Ç—Ä–∏–∫—É**

---

### 2. –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ—Å—Ç—å –æ—à–∏–±–∫–∏
**–í–æ–ø—Ä–æ—Å:** –û–¥–∏–Ω–∞–∫–æ–≤–∞ –ª–∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ—à–∏–±–∫–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—É –Ω–µ–¥–æ–ø—Ä–æ–≥–Ω–æ–∑–∞ –∏ –ø–µ—Ä–µ–ø—Ä–æ–≥–Ω–æ–∑–∞?

- –û—à–∏–±–∫–∞ –≤ ‚àí100 –∏ +100 –∑–∞–∫–∞–∑–æ–≤ ‚Äî —ç—Ç–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ –ø–ª–æ—Ö–æ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞?

#### –¢–∏–ø—ã –æ—à–∏–±–æ–∫

| –¢–∏–ø –æ—à–∏–±–∫–∏ | –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è |
|------------|-------------|
| **–ù–µ–¥–æ–ø—Ä–æ–≥–Ω–æ–∑** (pred < true) | –ü–æ—Ç–µ—Ä—è –ø—Ä–∏–±—ã–ª–∏ –∏–∑-–∑–∞ –¥–µ—Ñ–∏—Ü–∏—Ç–∞ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ –ø–æ–ª–∫–µ |
| **–ü–µ—Ä–µ–ø—Ä–æ–≥–Ω–æ–∑** (pred > true) | –ò–∑–±—ã—Ç–æ–∫ —Ç–æ–≤–∞—Ä–∞ ‚Üí –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ, —É—Ç–∏–ª–∏–∑–∞—Ü–∏—é |

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–∞ üç´/üçå

### –û–±—ã—á–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (–Ω–µ–ø–æ—Ä—Ç—è—â–∏–µ—Å—è)
**–ü—Ä–∞–≤–∏–ª–æ:** –õ—É—á—à–µ, –µ—Å–ª–∏ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ –ø–æ–ª–∫–µ **–±–æ–ª—å—à–µ**, —á–µ–º —Ö–æ—Ç—è—Ç –∫—É–ø–∏—Ç—å

- **–ü—É—Å—Ç—ã–µ –ø–æ–ª–∫–∏** ‚Äî —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π —Å—Ç—Ä–∞—Ö —Ä–∏—Ç–µ–π–ª–µ—Ä–∞
- –ü—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª–µ–Ω **–Ω–µ–±–æ–ª—å—à–æ–π –ø–µ—Ä–µ–ø—Ä–æ–≥–Ω–æ–∑**

### –°–∫–æ—Ä–æ–ø–æ—Ä—Ç—è—â–∏–µ—Å—è —Ç–æ–≤–∞—Ä—ã
**–ü—Ä–∞–≤–∏–ª–æ:** –õ—É—á—à–µ **–Ω–µ–¥–æ–ø—Ä–æ–≥–Ω–æ–∑**, —á–µ–º –ø–µ—Ä–µ–ø—Ä–æ–≥–Ω–æ–∑

**–ü—Ä–∏—á–∏–Ω—ã:**
- –°—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏ –∏–∑-–∑–∞ **—É—Ç–∏–ª–∏–∑–∞—Ü–∏–∏** –∏—Å–ø–æ—Ä—á–µ–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–π –∏–º–∏–¥–∂: –∫–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç –≥–Ω–∏–ª–æ–π –±–∞–Ω–∞–Ω/–ø–æ–º–∏–¥–æ—Ä –Ω–∞ –ø–æ–ª–∫–µ üçå‚ùå

> **–í—ã–≤–æ–¥:** ML-–º–µ—Ç—Ä–∏–∫–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–∞!

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
- –ú–µ—Ç—Ä–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–º–∏**
- –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—Ç **0 –¥–æ 100%**
- –õ–µ–≥–∫–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã–º–∏

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏

#### 1. MAPE (Mean Absolute Percentage Error)
$$
\text{MAPE} = \frac{\sum |y - y_{\text{true}}|}{\sum y_{\text{true}}}
$$

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç **—Å—Ä–µ–¥–Ω—é—é –≤–µ–ª–∏—á–∏–Ω—É –æ—à–∏–±–∫–∏** –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö.

#### 2. Bias (–°–º–µ—â–µ–Ω–∏–µ)
$$
\text{Bias} = \frac{\sum (y - y_{\text{true}})}{\sum y_{\text{true}}}
$$

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç **–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏** (–Ω–µ–¥–æ- –∏–ª–∏ –ø–µ—Ä–µ–ø—Ä–æ–≥–Ω–æ–∑).

---

## –¶–µ–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

### –û–±—ã—á–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
- –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å **MAPE**
- –ü—Ä–∏ **Bias** –æ—Ç **+1% –¥–æ +5%** (–Ω–µ–±–æ–ª—å—à–æ–π –ø–µ—Ä–µ–ø—Ä–æ–≥–Ω–æ–∑ –¥–æ–ø—É—Å—Ç–∏–º)

### –°–∫–æ—Ä–æ–ø–æ—Ä—Ç—è—â–∏–µ—Å—è —Ç–æ–≤–∞—Ä—ã
- –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å **MAPE**
- –ü—Ä–∏ **Bias** –æ—Ç **‚àí1% –¥–æ ‚àí5%** (–Ω–µ–±–æ–ª—å—à–æ–π –Ω–µ–¥–æ–ø—Ä–æ–≥–Ω–æ–∑ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª–µ–Ω)

---

## –í–∞–∂–Ω–æ–µ —É—Ç–æ—á–Ω–µ–Ω–∏–µ: WAPE

**‚ö†Ô∏è –ù–µ –∑–∞–±—ã–≤–∞–µ–º:** –º–µ—Ç—Ä–∏–∫–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ—Ä—è—Ç—å –¥–ª—è **–∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–±—ã–ª–∏**, –∞ –Ω–µ –ø—Ä–æ–¥–∞–∂!

### WAPE (Weighted Average Percent Error)
$$
\text{WAPE} = \frac{\sum |(\Delta \text{Profit}) - (\Delta \text{Profit}_{\text{true}})|}{\sum \Delta \text{Profit}_{\text{true}}}
$$

–í–∑–≤–µ—à–µ–Ω–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞, —É—á–∏—Ç—ã–≤–∞—é—â–∞—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –æ—à–∏–±–æ–∫.

---

## –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç—Ä–∏–∫–∏, –Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç 0 –¥–æ 100%** ‚Äî –∏—Ö –ª–µ–≥–∫–æ –æ–±—ä—è—Å–Ω–∏—Ç—å –±–∏–∑–Ω–µ—Å—É

‚úÖ **–£—á–∏—Ç—ã–≤–∞–π—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ—à–∏–±–∫–∏** –≤ –±–æ–ª—å—à—É—é –∏ –º–µ–Ω—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—ã (–∞—Å–∏–º–º–µ—Ç—Ä–∏—é)

‚úÖ **–ê–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ —Ü–µ–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è Bias** –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–∞

‚úÖ **–ò–∑–º–µ—Ä—è–π—Ç–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–∏–±—ã–ª—å** (WAPE), –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –ø—Ä–æ–¥–∞–∂–∏

# RMSE vs MAE: —Ä–∞–∑–≤–µ–Ω—á–∞–Ω–∏–µ –º–∏—Ñ–æ–≤

## –ú–∏—Ñ #1: "–ü—Ä–∏ —Å–∫–æ—à–µ–Ω–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ MAE"

### ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ
> "–ü—Ä–∏ —Å–∫–æ—à–µ–Ω–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è—Ö —Ç–∞—Ä–≥–µ—Ç–∞ —Å –¥–ª–∏–Ω–Ω—ã–º —Ö–≤–æ—Å—Ç–æ–º –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MAE, —Ç–∞–∫ –∫–∞–∫ MAE –º–µ–Ω—å—à–µ —à—Ç—Ä–∞—Ñ—É–µ—Ç –∑–∞ –±–æ–ª—å—à–∏–µ –æ—à–∏–±–∫–∏"

### ‚úÖ –ü—Ä–∞–≤–¥–∞
**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∞—Ä–≥–µ—Ç–∞ –Ω–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è. –í–∞–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫** $(y_{\text{true}} - y_{\text{pred}})$ **–º–æ–¥–µ–ª–∏**

- –û—à–∏–±–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞ **–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–≤—è–∑–∞–Ω–∞** —Å —Ñ–æ—Ä–º–æ–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∞—Ä–≥–µ—Ç–∞
- –£ –º–æ–¥–µ–ª–∏ –Ω–∞ –ª–æ–≥-–Ω–æ—Ä–º–∞–ª—å–Ω–æ–º —Ç–∞—Ä–≥–µ—Ç–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—à–∏–±–∫–∏, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- –ü–æ —ç—Ç–æ–π –∂–µ –ø—Ä–∏—á–∏–Ω–µ **–Ω–µ –Ω—É–∂–Ω–æ —Å—Ö–æ–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RMSLE** –Ω–∞ —Å–∫–æ—à–µ–Ω–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è—Ö

---

## –ß—Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É—é—Ç MAE –∏ RMSE?

| –ú–µ—Ç—Ä–∏–∫–∞ | –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ—Ç | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|---------|--------------|-------------------|
| **MAE** | –ú–µ–¥–∏–∞–Ω—É | –†–∞–∑–Ω–∞—è —Ü–µ–Ω–∞ –æ—à–∏–±–∫–∏ –≤ ¬± —Å—Ç–æ—Ä–æ–Ω—ã |
| **RMSE** | –°—Ä–µ–¥–Ω–µ–µ | –ù—É–∂–Ω–æ $E(\cdot)$ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ |

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è RMSE
–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º **—Å—Ä–µ–¥–Ω–µ–µ**, –∫–æ–≥–¥–∞ –æ–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è:

$$
E(\text{–≤—ã—Ä—É—á–∫–∞}) = \text{—Ü–µ–Ω–∞} \times E(\text{—Å–ø—Ä–æ—Å})
$$

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –∑–∞–¥–∞—á–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ü–µ–Ω, –ø—Ä–æ–º–æ ‚Üí –∏—Å–ø–æ–ª—å–∑—É—é—Ç **RMSE**

*–¢–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Poisson/Tweedie loss, –Ω–æ —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–µ–º–∞*

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è MAE (–∫–≤–∞–Ω—Ç–∏–ª—å–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏)
–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º **–º–µ–¥–∏–∞–Ω—É** –∏–ª–∏ –ª—é–±–æ–π **–∫–≤–∞–Ω—Ç–∏–ª—å** –ø—Ä–∏ —Ä–∞–∑–Ω–æ–π —Ü–µ–Ω–µ –æ—à–∏–±–∫–∏ –≤ –±–æ–ª—å—à—É—é/–º–µ–Ω—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—ã.

**–ü—Ä–∏–º–µ—Ä:** –ø—Ä–æ–≥–Ω–æ–∑ —Å–ø—Ä–æ—Å–∞ –¥–ª—è –∑–∞–∫—É–ø–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤
- –û–±—ã—á–Ω–æ –ª—É—á—à–µ —Å–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å **—á—É—Ç—å –±–æ–ª—å—à–µ —Ñ–∞–∫—Ç–∞** ‚Üí –∑–∞–∫—É–ø–∏—Ç—å —á—É—Ç—å –±–æ–ª—å—à–µ —Ç–æ–≤–∞—Ä–æ–≤
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–∫–≤–∞–Ω—Ç–∏–ª—å–Ω—ã–π loss** –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, 60-–π –∫–≤–∞–Ω—Ç–∏–ª—å

---

## –ü—Ä–æ–±–ª–µ–º—ã –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫

**–ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** (RMSE, MAE, RMSLE) —Ö–æ—Ä–æ—à–∏ –ø—Ä–æ—Å—Ç–æ—Ç–æ–π, –Ω–æ –∏–º–µ—é—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:

1. **–°–ª–æ–∂–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å** –¥–ª—è –±–∏–∑–Ω–µ—Å–∞
   - "–£ –º–æ–¥–µ–ª–∏ MAE = 307"
   - "–ò —á—Ç–æ? –•–æ—Ä–æ—à–∞ –ª–∏ –º–æ–¥–µ–ª—å?"

2. **–ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ —Ä–∞–∑–Ω–æ—Ä–æ–¥–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö**
   - –¢–æ–≤–∞—Ä –ê: 1000 –ø—Ä–æ–¥–∞–∂/–Ω–µ–¥–µ–ª—é
   - –¢–æ–≤–∞—Ä –ë: 5 –ø—Ä–æ–¥–∞–∂/–Ω–µ–¥–µ–ª—é
   - –£—Å—Ä–µ–¥–Ω–µ–Ω–Ω—ã–π RMSE ‚Äî –Ω–µ—á—Ç–æ —Å—Ç—Ä–∞–Ω–Ω–æ–µ

**–†–µ—à–µ–Ω–∏–µ:** –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏!

---

## MAPE (Mean Absolute Percentage Error)

$$
\text{MAPE} = \text{MEAN}\left(\frac{|y_{\text{true}} - y_{\text{pred}}|}{y_{\text{true}}}\right)
$$

### –¢–∏–ø—ã —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è

| –¢–∏–ø | –§–æ—Ä–º—É–ª–∞ | –ê–Ω–∞–ª–æ–≥ |
|-----|---------|--------|
| **Macro average** | –ú–µ—Ç—Ä–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –æ–±—ä–µ–∫—Ç—É ‚Üí —É—Å—Ä–µ–¥–Ω—è–µ–º | MAPE |
| **Micro average** | –°—É–º–º–∏—Ä—É–µ–º —á–∏—Å–ª–∏—Ç–µ–ª–∏ –∏ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ ‚Üí –¥–µ–ª–∏–º | MAE |

$$
\text{Micro MAPE} = \frac{\text{MAE}}{\text{mean}(y_{\text{true}})}
$$

### –ü—Ä–æ–±–ª–µ–º—ã MAPE

‚ùå –ú–æ–∂–µ—Ç –±—ã—Ç—å **> 1** (> 100%)

‚ùå **–ù–µ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞**: –ø–æ-—Ä–∞–∑–Ω–æ–º—É —à—Ç—Ä–∞—Ñ—É–µ—Ç –Ω–µ–¥–æ- –∏ –ø–µ—Ä–µ–ø—Ä–æ–≥–Ω–æ–∑

‚ùå **–ü–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –º–∞–ª–µ–Ω—å–∫–∏—Ö** $y_{\text{true}}$

**–†–µ—à–µ–Ω–∏–µ –¥–ª—è –º–∞–ª—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:**
$$
\text{MAPE}_{\text{offset}} = \text{MEAN}\left(\frac{|y_{\text{true}} - y_{\text{pred}}|}{y_{\text{true}} + \text{offset}}\right)
$$

---

## MAPE: –ø—Ä–æ–±–ª–µ–º–∞ –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ—Å—Ç–∏

–î–ª—è –∑–∞–¥–∞—á —Å $y \geq 0$ (–ø—Ä–æ–¥–∞–∂–∏, —Ü–µ–Ω—ã):

### –ù–µ–¥–æ–ø—Ä–æ–≥–Ω–æ–∑
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ = 0
- –ú–∞–∫—Å–∏–º—É–º: $\frac{|y_{\text{true}} - 0|}{y_{\text{true}}} = 100\%$

### –ü–µ—Ä–µ–ø—Ä–æ–≥–Ω–æ–∑
- –ú–æ–∂–µ—Ç —É—Ö–æ–¥–∏—Ç—å –≤ **–±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å**
- –ü—Ä–∏–º–µ—Ä: $\frac{|1 - 8|}{1} = 700\%$

> **–í—ã–≤–æ–¥:** MAPE **–±–æ–ª—å—à–µ —à—Ç—Ä–∞—Ñ—É–µ—Ç –∑–∞ –ø–µ—Ä–µ–ø—Ä–æ–≥–Ω–æ–∑** ‚Üí ML-–º–æ–¥–µ–ª–∏ **–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –Ω–µ–¥–æ–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å**

---

## SMAPE (Symmetric MAPE) ‚Äî –Ω–µ —Ç–∞–∫ —Å–∏–º–º–µ—Ç—Ä–∏—á–µ–Ω!

$$
\text{SMAPE} = \frac{|y_{\text{true}} - y_{\text{pred}}|}{(y_{\text{true}} + y_{\text{pred}}) / 2}
$$

**–ó–∞–±–∞–≤–Ω—ã–π —Ñ–∞–∫—Ç:** Symmetric MAPE **–Ω–µ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π**! üôÉ

---

## MALE: –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è MAPE –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞:** —É MAPE –Ω–µ–ø—Ä–∏—è—Ç–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:** –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ **MALE** (Mean Absolute Logarithmic Error)

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

1. $\ln(1 + f(x)) \approx f(x)$ –ø—Ä–∏ $f(x) \to 0$

2. $\ln\left(1 + \frac{|y_{\text{true}} - y_{\text{pred}}|}{y_{\text{pred}}}\right) \to \frac{|y_{\text{true}} - y_{\text{pred}}|}{y_{\text{pred}}} = \text{MAPE}$

3. $\ln(y_{\text{pred}} + |y_{\text{true}} - y_{\text{pred}}|) - \ln(y_{\text{true}}) \to \text{MAPE}$

4. –ü—Ä–∏ $\frac{|y_{\text{true}} - y_{\text{pred}}|}{y_{\text{pred}}} \to 0$ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è $|y_{\text{true}} - y_{\text{pred}}| \to 0$

5. $\ln(y_{\text{pred}} + |y_{\text{true}} - y_{\text{pred}}|) - \ln(y_{\text{true}}) \to \ln(y_{\text{pred}}) - \ln(y_{\text{true}})$

6. –í–∑—è–≤ –º–æ–¥—É–ª—å: **MALE** $\to$ **MAPE** –ø—Ä–∏ –Ω–µ–±–æ–ª—å—à–∏—Ö —Ä–∞–∑–Ω–∏—Ü–∞—Ö

### ‚úÖ –•–æ—Ä–æ—à–∏–π —Ä–µ—Ü–µ–ø—Ç
- **Loss** = MALE (–¥–ª—è –æ–±—É—á–µ–Ω–∏—è)
- **–ú–µ—Ç—Ä–∏–∫–∞** = MAPE (–¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏/—Ç–µ—Å—Ç–∞)

---

## MALE –∏ RMSLE (Logarithmic)

–ú–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –ª–æ–≥–∞—Ä–∏—Ñ–º–∞—Ö —Ç–∞—Ä–≥–µ—Ç–∞: $\ln(1 + y)$

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç
- –£ —Ç–∞—Ä–≥–µ—Ç–∞ **–±–æ–ª—å—à–æ–π —Ä–∞–∑–±—Ä–æ—Å –∑–Ω–∞—á–µ–Ω–∏–π**
- –ü—Ä–∏–º–µ—Ä: –ø—Ä–æ–¥–∞–∂–∏ —Ç–æ–≤–∞—Ä–æ–≤ (–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ 0-2 —à—Ç, —Ä–µ–¥–∫–∏–µ >1000 —à—Ç)
- –ü–æ–º–æ–≥–∞–µ—Ç –Ω–µ –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å—Å—è –ø–æ–¥ —Ç–æ–≤–∞—Ä—ã —Å –±–æ–ª—å—à–∏–º–∏ –ø—Ä–æ–¥–∞–∂–∞–º–∏

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
–õ–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–Ω–æ—Å–∏—Ç **–Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å** –ø–æ —Ñ–∏—á–∞–º:

–î–ª—è –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –Ω–∞ $\ln(1 + y)$:
$$
y = \exp(a_0 + a_1 x_1 + a_2 x_2) - 1
$$
–ò—Ç–æ–≥–æ–≤—ã–π –ø—Ä–æ–≥–Ω–æ–∑ **–Ω–µ–ª–∏–Ω–µ–µ–Ω** –ø–æ —Ñ–∏—á–∞–º –∏–∑-–∑–∞ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç—ã.

---

## ‚ö†Ô∏è –ö–æ–≥–¥–∞ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø—Ä–∞–≤–¥–∞–Ω–æ

### ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ, –µ—Å–ª–∏:
- –ó–Ω–∞—á–µ–Ω–∏—è —Ç–∞—Ä–≥–µ—Ç–∞ $\geq 0$
- **–ï—Å—Ç—å —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ** –ª–æ–≥–∞—Ä–∏—Ñ–º–∞ —Ç–∞—Ä–≥–µ—Ç–∞
- –ü—Ä–∏–º–µ—Ä: –æ—Ü–µ–Ω–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–ø—Ä–æ—Å–∞ ‚Üí [–ª–æ–≥-–ª–∏–Ω–µ–π–Ω—ã–µ –∏ –ª–æ–≥-–ª–æ–≥ –º–æ–¥–µ–ª–∏](https://studme.org/198436/ekonomika/logarifmicheskie_lineynye_modeli)

### ‚ùå –ë—É–¥—å—Ç–µ –∞–∫–∫—É—Ä–∞—Ç–Ω—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ:

1. **–¢–µ—Ä—è–µ—Ç—Å—è —Å–≤—è–∑—å —Å –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–µ–π**
   - –ë–∏–∑–Ω–µ—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –ø—Ä–æ–≥–Ω–æ–∑ $y$, –∞ –Ω–µ $\ln(1+y)$

2. **–ù–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ –≤–ª–∏—è–Ω–∏–µ —Ñ–∏—á–∏**
   - –ò–∑-–∑–∞ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ–±–æ–ª—å—à–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏—á–∏ –º–æ–∂–µ—Ç —Å–∏–ª—å–Ω–æ –º–µ–Ω—è—Ç—å –ø—Ä–æ–≥–Ω–æ–∑

3. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ ‚â† –ø–æ–≤–æ–¥**
   - –õ–æ–≥-–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∞—Ä–≥–µ—Ç–∞ ‚Äî **–Ω–µ –ø–æ–≤–æ–¥** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MALE –∏ RMSLE

---

## –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

‚úÖ –í—ã–±–∏—Ä–∞–π—Ç–µ –º–µ—Ç—Ä–∏–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–µ **—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫**, –∞ –Ω–µ —Ç–∞—Ä–≥–µ—Ç–∞

‚úÖ RMSE –¥–ª—è –∑–∞–¥–∞—á –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–Ω—É–∂–Ω–æ —Å—Ä–µ–¥–Ω–µ–µ –¥–ª—è $E(\cdot)$)

‚úÖ MAE/–∫–≤–∞–Ω—Ç–∏–ª—å–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è –ø—Ä–∏ –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–π —Ü–µ–Ω–µ –æ—à–∏–±–æ–∫

‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (MAPE) –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å—É

‚úÖ MALE –∫–∞–∫ loss, MAPE –∫–∞–∫ –º–µ—Ç—Ä–∏–∫–∞ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

‚úÖ –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–º –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–∏


# Refs

- [–î—å—è–∫–æ–Ω–æ–≤ ‚Äî AUC ROC (–ø–ª–æ—â–∞–¥—å –ø–æ–¥ –∫—Ä–∏–≤–æ–π –æ—à–∏–±–æ–∫)](https://alexanderdyakonov.wordpress.com/2017/07/28/auc-roc-%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%D0%B4%D1%8C-%D0%BF%D0%BE%D0%B4-%D0%BA%D1%80%D0%B8%D0%B2%D0%BE%D0%B9-%D0%BE%D1%88%D0%B8%D0%B1%D0%BE%D0%BA/comment-page-1/)
- [Understanding ROC-AUC](https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5)
- [PR-AUC vs ROC-AUC](https://www.linkedin.com/feed/update/activity:7250079790420897792)
- [Cross-Validation Techniques](https://www.linkedin.com/feed/update/activity:7082846284994224128/)
- [On Sampled Metrics for Item Recommendations](https://dl.acm.org/doi/pdf/10.1145/3394486.3403226)
- [Mean Average Precision (MAP) for Recommender Systems](http://sdsawtelle.github.io/blog/output/mean-average-precision-MAP-for-recommender-systems.html)
- [ROC Curve Drawbacks](https://stats.stackexchange.com/questions/193138/roc-curve-drawbacks)
- [Understanding ROC-AUC: Pros and Cons. Why Brier Score Is a Good Supplement](https://medium.com/@penggongting/understanding-roc-auc-pros-and-cons-why-is-bier-score-a-great-supplement-c7a0c976b679)
- [Evaluation Metrics, ROC Curves, and Imbalanced Datasets](https://aman.ai/primers/ai/evaluation-metrics/#area-under-the-roc-curve-auroc)
- [Imbalanced datasets tricks](https://datascience.stackexchange.com/questions/134389/is-class-imbalance-really-a-problem-in-machine-learning)
- [Disadvantages of Using the Area Under the ROC Curve](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4356897/pdf/330_2014_Article_3487.pdf)
- [Indifference Curve](https://nicolas.kruchten.com/content/2016/01/ml-meets-economics/)
- [–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è](https://habr.com/ru/company/econtenta/blog/303458/)
- [Scikit-learn Metrics and Scoring](https://scikit-learn.org/stable/modules/model_evaluation.html)
- [Choosing Metrics for Recommender System Evaluation](https://wiki.epfl.ch/edicpublic/documents/Candidacy%20exam/Evaluation.pdf)
- [Statistical Evaluation Metrics](http://iust-projects.ir/post/minidm01/)
- [F1-score vs Accuracy vs ROC-AUC vs PR-AUC](https://neptune.ai/blog/f1-score-accuracy-roc-auc-pr-auc)
- [Evaluation of Ranked Retrieval Results](https://nlp.stanford.edu/IR-book/html/htmledition/evaluation-of-ranked-retrieval-results-1.html)
- [Evaluation Metrics for Item Recommendation under Sampling](https://arxiv.org/pdf/1912.02263.pdf)
- [Choosing the Right Metric Is a Huge Issue](https://towardsdatascience.com/choosing-the-right-metric-is-a-huge-issue-99ccbe73de61)
- [MRR vs MAP vs NDCG](https://medium.com/swlh/rank-aware-recsys-evaluation-metrics-5191bba16832)
- [Understanding NDCG](https://medium.com/@readsumant/understanding-ndcg-as-a-metric-for-your-recomendation-system-5cd012fb3397)
- [Discounted Cumulative Gain (DCG)](https://en.wikipedia.org/wiki/Discounted_cumulative_gain)
- [F1 vs AUC](https://neptune.ai/blog/f1-score-accuracy-roc-auc-pr-auc/)
- [What Is F1-score? (GetYourGuide)](https://medium.com/tech-getyourguide/whats-a-good-f1-score-b460caf27c90)
- [Ranking Metrics Explained](https://www.linkedin.com/posts/shirin-khosravi-jam_give-me-3-minutes-and-let-me-explain-the-activity-7315630687129157632-tI6X)
- [ROC-AUC Criticism](https://www.linkedin.com/posts/activity-7312050694616719360-OFS1/)
- [Roc_AUC](https://www.linkedin.com/posts/hoang-van-hao_machinelearning-deeplearning-mlengineering-activity-7400323682717528064-6etR)